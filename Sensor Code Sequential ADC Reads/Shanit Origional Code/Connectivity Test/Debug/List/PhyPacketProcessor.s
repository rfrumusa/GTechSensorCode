///////////////////////////////////////////////////////////////////////////////
//
// IAR ANSI C/C++ Compiler V7.20.5.7591/W32 for ARM       02/Sep/2018  14:19:40
// Copyright 1999-2014 IAR Systems AB.
//
//    Cpu mode     =  thumb
//    Endian       =  little
//    Source file  =  
//        F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity
//        Test\PLM\Source\Radio\MC1324x\PHY\PhyPacketProcessor.c
//    Command line =  
//        "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity
//        Test\PLM\Source\Radio\MC1324x\PHY\PhyPacketProcessor.c" -D IAR
//        --preprocess "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code
//        Sequential ADC Reads\Shanit Origional Code\Connectivity
//        Test\Debug\List\" -lC "F:\Guardrail Work\Sensor Code\Git Repo\Sensor
//        Code Sequential ADC Reads\Shanit Origional Code\Connectivity
//        Test\Debug\List\" -lB "F:\Guardrail Work\Sensor Code\Git Repo\Sensor
//        Code Sequential ADC Reads\Shanit Origional Code\Connectivity
//        Test\Debug\List\" --diag_suppress
//        Pe014,Pe001,Pe991,Pa039,Pe520,Pe550,Pe177,Pa082 -o "F:\Guardrail
//        Work\Sensor Code\Git Repo\Sensor Code Sequential ADC Reads\Shanit
//        Origional Code\Connectivity Test\Debug\Obj\" --no_cse --no_unroll
//        --no_inline --no_code_motion --no_tbaa --no_clustering
//        --no_scheduling --debug --endian=little --cpu=Cortex-M4 -e --fpu=None
//        --dlib_config "C:\Program Files (x86)\IAR Systems\Embedded Workbench
//        7.0\arm\INC\c\DLib_Config_Normal.h" -I "F:\Guardrail Work\Sensor
//        Code\Git Repo\Sensor Code Sequential ADC Reads\Shanit Origional
//        Code\Connectivity Test\PLM\Configure\" -I "F:\Guardrail Work\Sensor
//        Code\Git Repo\Sensor Code Sequential ADC Reads\Shanit Origional
//        Code\Connectivity Test\PLM\Environment\" -I "F:\Guardrail Work\Sensor
//        Code\Git Repo\Sensor Code Sequential ADC Reads\Shanit Origional
//        Code\Connectivity Test\PLM\Interface\" -I "F:\Guardrail Work\Sensor
//        Code\Git Repo\Sensor Code Sequential ADC Reads\Shanit Origional
//        Code\Connectivity Test\Generic Services\Interface\" -I "F:\Guardrail
//        Work\Sensor Code\Git Repo\Sensor Code Sequential ADC Reads\Shanit
//        Origional Code\Connectivity Test\PLM\Source\Uart\" -I "F:\Guardrail
//        Work\Sensor Code\Git Repo\Sensor Code Sequential ADC Reads\Shanit
//        Origional Code\Connectivity Test\PLM\Source\USB\" -I "F:\Guardrail
//        Work\Sensor Code\Git Repo\Sensor Code Sequential ADC Reads\Shanit
//        Origional Code\Connectivity Test\PLM\Source\USB\APP\" -I
//        "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity
//        Test\PLM\Source\USB\APP\CDC\" -I "F:\Guardrail Work\Sensor Code\Git
//        Repo\Sensor Code Sequential ADC Reads\Shanit Origional
//        Code\Connectivity Test\PLM\Source\USB\APP\Descriptor\" -I
//        "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\PLM\Source\USB\Class\"
//        -I "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\PLM\Source\USB\Common\"
//        -I "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\PLM\Source\USB\Driver\"
//        -I "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\PLM\Source\TMR\" -I
//        "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity
//        Test\PLM\Source\Radio\MC1324x\PHY\" -I "F:\Guardrail Work\Sensor
//        Code\Git Repo\Sensor Code Sequential ADC Reads\Shanit Origional
//        Code\Connectivity Test\PLM\Source\Radio\MC1324x\DRV\" -I
//        "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\PLM\Source\Sys Common\"
//        -I "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\SMAC\Source\" -I
//        "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\SMAC\Interface\" -I
//        "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\SMAC\Configure\" -I
//        "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\Application\Source\" -I
//        "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\Application\Configure\"
//        -I "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\PLM\Source\NVM\" -I
//        "C:\Users\Robert\SkyDrive\2018 Spring Semester\Senior Design\Sensor
//        Code\Shanit Origional Code\Connectivity Test\PLM\Source\NVM\" -I
//        "C:\Users\Robert\SkyDrive\2018 Spring Semester\Senior Design\Sensor
//        Code\Shanit Origional Code\Connectivity Test\PLM\Source\ADC\" -I
//        "C:\Users\rfrum\OneDrive\2018 Spring Semester\Senior Design\Sensor
//        Code\Shanit Origional Code\Connectivity Test\PLM\Source\ADC\" -I
//        "F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity Test\PLM\Source\LPM\" -On
//    List file    =  
//        F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC
//        Reads\Shanit Origional Code\Connectivity
//        Test\Debug\List\PhyPacketProcessor.s
//
///////////////////////////////////////////////////////////////////////////////

        #define SHT_PROGBITS 0x1

        EXTERN MC1324xDrv_DirectAccessSPIMultiByteWrite
        EXTERN MC1324xDrv_DirectAccessSPIRead
        EXTERN MC1324xDrv_DirectAccessSPIWrite
        EXTERN MC1324xDrv_IRQ_Clear
        EXTERN MC1324xDrv_IndirectAccessSPIMultiByteWrite
        EXTERN MC1324xDrv_IndirectAccessSPIRead
        EXTERN MC1324xDrv_IndirectAccessSPIWrite
        EXTERN NVIC_ClearPendingIRQ
        EXTERN PhyPassRxDataPtr
        EXTERN PhyPassRxParams
        EXTERN PhyPlmeSetCurrentChannelRequestPAN0
        EXTERN PhyPlmeSetPwrLevelRequest

        PUBLIC PhyAbort
        PUBLIC PhyInit
        PUBLIC PhyPpGetState
        PUBLIC PhyPpIsPollIndication
        PUBLIC PhyPpIsRxAckDataPending
        PUBLIC PhyPpIsTxAckDataPending
        PUBLIC PhyPpReadLatestIndex
        PUBLIC PhyPpSetCcaThreshold
        PUBLIC PhyPpSetLongAddrPAN0
        PUBLIC PhyPpSetLongAddrPAN1
        PUBLIC PhyPpSetMacRolePAN0
        PUBLIC PhyPpSetMacRolePAN1
        PUBLIC PhyPpSetPanIdPAN0
        PUBLIC PhyPpSetPanIdPAN1
        PUBLIC PhyPpSetPromiscuous
        PUBLIC PhyPpSetShortAddrPAN0
        PUBLIC PhyPpSetShortAddrPAN1
        PUBLIC PhyPp_AddToIndirect
        PUBLIC PhyPp_RemoveFromIndirect

// F:\Guardrail Work\Sensor Code\Git Repo\Sensor Code Sequential ADC Reads\Shanit Origional Code\Connectivity Test\PLM\Source\Radio\MC1324x\PHY\PhyPacketProcessor.c
//    1 /*****************************************************************************
//    2  *                               INCLUDED HEADERS                            *
//    3  *---------------------------------------------------------------------------*
//    4  * Add to this section all the headers that this module needs to include.    *
//    5  *---------------------------------------------------------------------------*
//    6  *****************************************************************************/
//    7 #include "EmbeddedTypes.h"
//    8 #include "PortConfig.h"
//    9 #include "TransceiverDrv.h"
//   10 #include "TransceiverReg.h"
//   11 #include "Phy.h"
//   12 #include "Interrupt.h"
//   13 
//   14 /*****************************************************************************
//   15  *                               PRIVATE VARIABLES                           *
//   16  *---------------------------------------------------------------------------*
//   17  * Add to this section all the variables and constants that have local       *
//   18  * (file) scope.                                                             *
//   19  * Each of this declarations shall be preceded by the 'static' keyword.      *
//   20  * These variables / constants cannot be accessed outside this module.       *
//   21  *---------------------------------------------------------------------------*
//   22  *****************************************************************************/
//   23 
//   24 // Address mode indentifiers. Used for both network and MAC interfaces
//   25 #define gPhyAddrModeNoAddr_c        (0)
//   26 #define gPhyAddrModeInvalid_c       (1)
//   27 #define gPhyAddrMode16BitAddr_c     (2)
//   28 #define gPhyAddrMode64BitAddr_c     (3)
//   29 
//   30 /*****************************************************************************
//   31  *                               PUBLIC VARIABLES                            *
//   32  *---------------------------------------------------------------------------*
//   33  * Add to this section all the variables and constants that have global      *
//   34  * (project) scope.                                                          *
//   35  * These variables / constants can be accessed outside this module.          *
//   36  * These variables / constants shall be preceded by the 'extern' keyword in  *
//   37  * the interface header.                                                     *
//   38  *---------------------------------------------------------------------------*
//   39  *****************************************************************************/
//   40 
//   41 /*****************************************************************************
//   42  *                           PRIVATE FUNCTIONS PROTOTYPES                    *
//   43  *---------------------------------------------------------------------------*
//   44  * Add to this section all the functions prototypes that have local (file)   *
//   45  * scope.                                                                    *
//   46  * These functions cannot be accessed outside this module.                   *
//   47  * These declarations shall be preceded by the 'static' keyword.             *
//   48  *---------------------------------------------------------------------------*
//   49  *****************************************************************************/
//   50 
//   51 /*****************************************************************************
//   52  *                                PRIVATE FUNCTIONS                          *
//   53  *---------------------------------------------------------------------------*
//   54  * Add to this section all the functions that have local (file) scope.       *
//   55  * These functions cannot be accessed outside this module.                   *
//   56  * These definitions shall be preceded by the 'static' keyword.              *
//   57  *---------------------------------------------------------------------------*
//   58  *****************************************************************************/
//   59 
//   60 /*****************************************************************************
//   61  *                             PUBLIC FUNCTIONS                              *
//   62  *---------------------------------------------------------------------------*
//   63  * Add to this section all the functions that have global (project) scope.   *
//   64  * These functions can be accessed outside this module.                      *
//   65  * These functions shall have their declarations (prototypes) within the     *
//   66  * interface header file and shall be preceded by the 'extern' keyword.      *
//   67  *---------------------------------------------------------------------------*
//   68  *****************************************************************************/
//   69 
//   70 /*---------------------------------------------------------------------------
//   71  * Name: PhyPpSetPromiscuous
//   72  * Description: -
//   73  * Parameters: -
//   74  * Return: -
//   75  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//   76 void PhyPpSetPromiscuous
//   77 (
//   78   bool_t mode
//   79 )
//   80 {
PhyPpSetPromiscuous:
        PUSH     {R3-R5,LR}
        MOVS     R4,R0
//   81   uint8_t phyCtrl4Reg;
//   82   
//   83   phyCtrl4Reg = MC1324xDrv_DirectAccessSPIRead( (uint8_t) PHY_CTRL4);
        MOVS     R0,#+7
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R5,R0
//   84   
//   85   if(TRUE == mode)
        UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
        CMP      R4,#+1
        BNE.N    ??PhyPpSetPromiscuous_0
//   86   {
//   87     phyCtrl4Reg |= cPHY_CTRL4_PROMISCUOUS;
        ORRS     R5,R5,#0x2
        B.N      ??PhyPpSetPromiscuous_1
//   88   }
//   89   else
//   90   {
//   91     phyCtrl4Reg &= ~cPHY_CTRL4_PROMISCUOUS;
??PhyPpSetPromiscuous_0:
        ANDS     R5,R5,#0xFD
//   92   }
//   93   MC1324xDrv_DirectAccessSPIWrite( (uint8_t) PHY_CTRL4, phyCtrl4Reg);
??PhyPpSetPromiscuous_1:
        MOVS     R1,R5
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+7
        BL       MC1324xDrv_DirectAccessSPIWrite
//   94 }
        POP      {R0,R4,R5,PC}    ;; return
//   95 
//   96 /*---------------------------------------------------------------------------
//   97  * Name: PhyPpSetPanIdPAN0
//   98  * Description: -
//   99  * Parameters: -
//  100  * Return: -
//  101  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  102 void PhyPpSetPanIdPAN0
//  103 (
//  104   uint8_t *pPanId
//  105 )
//  106 {
PhyPpSetPanIdPAN0:
        PUSH     {R4,LR}
        MOVS     R4,R0
//  107   //PHY_DEBUG_LOG(PDBG_PP_SET_PANID_PAN0); TODO
//  108 
//  109 #ifdef PHY_PARAMETERS_VALIDATION
//  110   if(NULL == pPanId)
//  111   {
//  112     return;
//  113   }
//  114 #endif // PHY_PARAMETERS_VALIDATION
//  115   
//  116   MC1324xDrv_IndirectAccessSPIMultiByteWrite((uint8_t) MACPANID0_LSB, pPanId, 2);
        MOVS     R2,#+2
        MOVS     R1,R4
        MOVS     R0,#+3
        BL       MC1324xDrv_IndirectAccessSPIMultiByteWrite
//  117 }
        POP      {R4,PC}          ;; return
//  118 
//  119 /*---------------------------------------------------------------------------
//  120  * Name: PhyPpSetPanIdPAN1
//  121  * Description: -
//  122  * Parameters: -
//  123  * Return: -
//  124  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  125 void PhyPpSetPanIdPAN1
//  126 (
//  127   uint8_t *pPanId
//  128 )
//  129 {
PhyPpSetPanIdPAN1:
        PUSH     {R4,LR}
        MOVS     R4,R0
//  130   //PHY_DEBUG_LOG(PDBG_PP_SET_PANID_PAN1); TODO
//  131 
//  132 #ifdef PHY_PARAMETERS_VALIDATION
//  133   if(NULL == pPanId)
//  134   {
//  135     return;
//  136   }
//  137 #endif // PHY_PARAMETERS_VALIDATION
//  138 
//  139   MC1324xDrv_IndirectAccessSPIMultiByteWrite((uint8_t) MACPANID1_LSB, pPanId, 2);
        MOVS     R2,#+2
        MOVS     R1,R4
        MOVS     R0,#+19
        BL       MC1324xDrv_IndirectAccessSPIMultiByteWrite
//  140 }
        POP      {R4,PC}          ;; return
//  141 
//  142 /*---------------------------------------------------------------------------
//  143  * Name: PhyPpSetShortAddrPAN0
//  144  * Description: -
//  145  * Parameters: -
//  146  * Return: -
//  147  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  148 void PhyPpSetShortAddrPAN0
//  149 (
//  150   uint8_t *pShortAddr
//  151 )
//  152 {
PhyPpSetShortAddrPAN0:
        PUSH     {R4,LR}
        MOVS     R4,R0
//  153   //PHY_DEBUG_LOG(PDBG_PP_SET_SHORTADDR_PAN0); TODO
//  154   
//  155 #ifdef PHY_PARAMETERS_VALIDATION
//  156   if(NULL == pShortAddr)
//  157   {
//  158     return;
//  159   }
//  160 #endif // PHY_PARAMETERS_VALIDATION
//  161 
//  162   MC1324xDrv_IndirectAccessSPIMultiByteWrite((uint8_t) MACSHORTADDRS0_LSB, pShortAddr, 2);
        MOVS     R2,#+2
        MOVS     R1,R4
        MOVS     R0,#+5
        BL       MC1324xDrv_IndirectAccessSPIMultiByteWrite
//  163 }
        POP      {R4,PC}          ;; return
//  164 
//  165 /*---------------------------------------------------------------------------
//  166  * Name: PhyPpSetShortAddrPAN1
//  167  * Description: -
//  168  * Parameters: -
//  169  * Return: -
//  170  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  171 void PhyPpSetShortAddrPAN1
//  172 (
//  173   uint8_t *pShortAddr
//  174 )
//  175 {
PhyPpSetShortAddrPAN1:
        PUSH     {R4,LR}
        MOVS     R4,R0
//  176   //PHY_DEBUG_LOG(PDBG_PP_SET_SHORTADDR_PAN1); TODO
//  177   
//  178 #ifdef PHY_PARAMETERS_VALIDATION
//  179   if(NULL == pShortAddr)
//  180   {
//  181     return;
//  182   }
//  183 #endif // PHY_PARAMETERS_VALIDATION
//  184 
//  185   MC1324xDrv_IndirectAccessSPIMultiByteWrite((uint8_t) MACSHORTADDRS1_LSB, pShortAddr, 2);
        MOVS     R2,#+2
        MOVS     R1,R4
        MOVS     R0,#+21
        BL       MC1324xDrv_IndirectAccessSPIMultiByteWrite
//  186 }
        POP      {R4,PC}          ;; return
//  187 
//  188 /*---------------------------------------------------------------------------
//  189  * Name: PhyPpSetLongAddrPAN0
//  190  * Description: -
//  191  * Parameters: -
//  192  * Return: -
//  193  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  194 void PhyPpSetLongAddrPAN0
//  195 (
//  196   uint8_t *pLongAddr
//  197 )
//  198 {
PhyPpSetLongAddrPAN0:
        PUSH     {R4,LR}
        MOVS     R4,R0
//  199   //PHY_DEBUG_LOG(PDBG_PP_SET_LONGADDR_PAN0); TODO
//  200 
//  201 #ifdef PHY_PARAMETERS_VALIDATION
//  202   if(NULL == pLongAddr)
//  203   {
//  204     return;
//  205   }
//  206 #endif // PHY_PARAMETERS_VALIDATION
//  207 
//  208   MC1324xDrv_IndirectAccessSPIMultiByteWrite((uint8_t) MACLONGADDRS0_0, pLongAddr, 8);
        MOVS     R2,#+8
        MOVS     R1,R4
        MOVS     R0,#+7
        BL       MC1324xDrv_IndirectAccessSPIMultiByteWrite
//  209 }
        POP      {R4,PC}          ;; return
//  210 
//  211 /*---------------------------------------------------------------------------
//  212  * Name: PhyPpSetLongAddrPAN1
//  213  * Description: -
//  214  * Parameters: -
//  215  * Return: -
//  216  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  217 void PhyPpSetLongAddrPAN1
//  218 (
//  219   uint8_t *pLongAddr
//  220 )
//  221 {
PhyPpSetLongAddrPAN1:
        PUSH     {R4,LR}
        MOVS     R4,R0
//  222   //PHY_DEBUG_LOG(PDBG_PP_SET_LONGADDR_PAN1); TODO
//  223 
//  224 #ifdef PHY_PARAMETERS_VALIDATION
//  225   if(NULL == pLongAddr)
//  226   {
//  227     return;
//  228   }
//  229 #endif // PHY_PARAMETERS_VALIDATION
//  230 
//  231   MC1324xDrv_IndirectAccessSPIMultiByteWrite((uint8_t) MACLONGADDRS1_0, pLongAddr, 8);
        MOVS     R2,#+8
        MOVS     R1,R4
        MOVS     R0,#+23
        BL       MC1324xDrv_IndirectAccessSPIMultiByteWrite
//  232 }
        POP      {R4,PC}          ;; return
//  233 
//  234 /*---------------------------------------------------------------------------
//  235  * Name: PhyPpSetMacRolePAN0
//  236  * Description: -
//  237  * Parameters: -
//  238  * Return: -
//  239  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  240 void PhyPpSetMacRolePAN0
//  241 (
//  242   bool_t macRole
//  243 )
//  244 {
PhyPpSetMacRolePAN0:
        PUSH     {R3-R5,LR}
        MOVS     R4,R0
//  245   uint8_t phyCtrl4Reg;
//  246   
//  247   //PHY_DEBUG_LOG(PDBG_PP_SET_MACROLE_PAN0); TODO
//  248   
//  249   phyCtrl4Reg = MC1324xDrv_DirectAccessSPIRead( (uint8_t) PHY_CTRL4);
        MOVS     R0,#+7
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R5,R0
//  250   
//  251   if(gMacRole_PanCoord_c == macRole)
        UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
        CMP      R4,#+1
        BNE.N    ??PhyPpSetMacRolePAN0_0
//  252   {
//  253     phyCtrl4Reg |=  cPHY_CTRL4_PANCORDNTR0;
        ORRS     R5,R5,#0x20
        B.N      ??PhyPpSetMacRolePAN0_1
//  254   }
//  255   else
//  256   {
//  257     phyCtrl4Reg &= ~cPHY_CTRL4_PANCORDNTR0;
??PhyPpSetMacRolePAN0_0:
        ANDS     R5,R5,#0xDF
//  258   }
//  259   MC1324xDrv_DirectAccessSPIWrite( (uint8_t) PHY_CTRL4, phyCtrl4Reg);
??PhyPpSetMacRolePAN0_1:
        MOVS     R1,R5
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+7
        BL       MC1324xDrv_DirectAccessSPIWrite
//  260 }
        POP      {R0,R4,R5,PC}    ;; return
//  261 
//  262 /*---------------------------------------------------------------------------
//  263  * Name: PhyPpSetMacRolePAN1
//  264  * Description: -
//  265  * Parameters: -
//  266  * Return: -
//  267  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  268 void PhyPpSetMacRolePAN1
//  269 (
//  270   bool_t macRole
//  271 )
//  272 {
PhyPpSetMacRolePAN1:
        PUSH     {R3-R5,LR}
        MOVS     R4,R0
//  273   uint8_t dualPanCtrlReg;
//  274   
//  275   //PHY_DEBUG_LOG(PDBG_PP_SET_MACROLE_PAN1); TODO
//  276   
//  277   dualPanCtrlReg = MC1324xDrv_IndirectAccessSPIRead( (uint8_t) DUAL_PAN_CTRL);
        MOVS     R0,#+31
        BL       MC1324xDrv_IndirectAccessSPIRead
        MOVS     R5,R0
//  278   
//  279   if(gMacRole_PanCoord_c == macRole)
        UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
        CMP      R4,#+1
        BNE.N    ??PhyPpSetMacRolePAN1_0
//  280   {
//  281     dualPanCtrlReg |=  cDUAL_PAN_CTRL_PANCORDNTR1;
        ORRS     R5,R5,#0x4
        B.N      ??PhyPpSetMacRolePAN1_1
//  282   }
//  283   else
//  284   {
//  285     dualPanCtrlReg &= ~cDUAL_PAN_CTRL_PANCORDNTR1;
??PhyPpSetMacRolePAN1_0:
        ANDS     R5,R5,#0xFB
//  286   }
//  287   MC1324xDrv_IndirectAccessSPIWrite( (uint8_t) DUAL_PAN_CTRL, dualPanCtrlReg);
??PhyPpSetMacRolePAN1_1:
        MOVS     R1,R5
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+31
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  288 }
        POP      {R0,R4,R5,PC}    ;; return
//  289 
//  290 /*---------------------------------------------------------------------------
//  291  * Name: PhyPpIsTxAckDataPending
//  292  * Description: -
//  293  * Parameters: -
//  294  * Return: -
//  295  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  296 bool_t PhyPpIsTxAckDataPending
//  297 (
//  298   void
//  299 )
//  300 {
PhyPpIsTxAckDataPending:
        PUSH     {R4,LR}
//  301   uint8_t irqsts2Reg;
//  302   irqsts2Reg = MC1324xDrv_DirectAccessSPIRead((uint8_t) IRQSTS2);
        MOVS     R0,#+1
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R4,R0
//  303   if(irqsts2Reg & cIRQSTS2_SRCADDR)
        LSLS     R0,R4,#+26
        BPL.N    ??PhyPpIsTxAckDataPending_0
//  304   {
//  305     return TRUE;
        MOVS     R0,#+1
        B.N      ??PhyPpIsTxAckDataPending_1
//  306   }
//  307   return FALSE;
??PhyPpIsTxAckDataPending_0:
        MOVS     R0,#+0
??PhyPpIsTxAckDataPending_1:
        POP      {R4,PC}          ;; return
//  308 }
//  309 
//  310 /*---------------------------------------------------------------------------
//  311  * Name: PhyPpIsRxAckDataPending
//  312  * Description: -
//  313  * Parameters: -
//  314  * Return: -
//  315  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  316 bool_t PhyPpIsRxAckDataPending
//  317 (
//  318   void
//  319 )
//  320 {
PhyPpIsRxAckDataPending:
        PUSH     {R4,LR}
//  321   uint8_t irqsts1Reg;
//  322   irqsts1Reg = MC1324xDrv_DirectAccessSPIRead((uint8_t) IRQSTS1);
        MOVS     R0,#+0
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R4,R0
//  323   if(irqsts1Reg & cIRQSTS1_RX_FRM_PEND)
        LSLS     R0,R4,#+24
        BPL.N    ??PhyPpIsRxAckDataPending_0
//  324   {
//  325     return TRUE;
        MOVS     R0,#+1
        B.N      ??PhyPpIsRxAckDataPending_1
//  326   }
//  327   return FALSE;
??PhyPpIsRxAckDataPending_0:
        MOVS     R0,#+0
??PhyPpIsRxAckDataPending_1:
        POP      {R4,PC}          ;; return
//  328 }
//  329 
//  330 /*---------------------------------------------------------------------------
//  331  * Name: PhyPpIsPollIndication
//  332  * Description: -
//  333  * Parameters: -
//  334  * Return: -
//  335  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  336 bool_t PhyPpIsPollIndication
//  337 (
//  338   void
//  339 )
//  340 {
PhyPpIsPollIndication:
        PUSH     {R4,LR}
//  341   uint8_t irqsts2Reg;
//  342   irqsts2Reg = MC1324xDrv_DirectAccessSPIRead((uint8_t) IRQSTS2);
        MOVS     R0,#+1
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R4,R0
//  343   if(irqsts2Reg & cIRQSTS2_PI)
        LSLS     R0,R4,#+27
        BPL.N    ??PhyPpIsPollIndication_0
//  344   {
//  345     return TRUE;
        MOVS     R0,#+1
        B.N      ??PhyPpIsPollIndication_1
//  346   }
//  347   return FALSE;
??PhyPpIsPollIndication_0:
        MOVS     R0,#+0
??PhyPpIsPollIndication_1:
        POP      {R4,PC}          ;; return
//  348 }
//  349 
//  350 /*---------------------------------------------------------------------------
//  351  * Name: PhyPpSetCcaThreshold
//  352  * Description: -
//  353  * Parameters: -
//  354  * Return: -
//  355  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  356 void PhyPpSetCcaThreshold(uint8_t ccaThreshold)
//  357 {
PhyPpSetCcaThreshold:
        PUSH     {R4,LR}
        MOVS     R4,R0
//  358   MC1324xDrv_IndirectAccessSPIWrite((uint8_t) CCA1_THRESH, (uint8_t) ccaThreshold);
        MOVS     R1,R4
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+34
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  359 }
        POP      {R4,PC}          ;; return
//  360 
//  361 /*---------------------------------------------------------------------------
//  362  * Name: PhyPp_AddToIndirect
//  363  * Description: -
//  364  * Parameters: -
//  365  * Return: -
//  366  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  367 void PhyPp_AddToIndirect
//  368 (
//  369   uint8_t index,
//  370   uint8_t *pPanId,
//  371   uint8_t *pAddr,
//  372   uint8_t AddrMode
//  373 )
//  374 {
PhyPp_AddToIndirect:
        PUSH     {R4-R8,LR}
        SUB      SP,SP,#+8
        MOVS     R4,R0
        MOVS     R5,R1
        MOVS     R6,R2
        MOVS     R7,R3
//  375   uint16_t srcAddressCheckSum;
//  376   uint8_t srcCtrlReg;
//  377   
//  378   //PHY_DEBUG_LOG1(PDBG_PP_ADD_INDIRECT, index); TODO
//  379   
//  380 #ifdef PHY_PARAMETERS_VALIDATION
//  381   if((NULL == pPanId) || (NULL == pAddr))
//  382   {
//  383     return;
//  384   }
//  385   if( (gPhyAddrMode64BitAddr_c != AddrMode) && (gPhyAddrMode16BitAddr_c != AddrMode) )
//  386   {
//  387     return;
//  388   }
//  389 #endif // PHY_PARAMETERS_VALIDATION
//  390 
//  391   srcAddressCheckSum = (uint16_t ) ( (uint16_t) pPanId[0] | (uint16_t) (pPanId[1] << 8) );
        LDRB     R0,[R5, #+0]
        LDRB     R1,[R5, #+1]
        ORRS     R0,R0,R1, LSL #+8
        STRH     R0,[SP, #+0]
//  392       srcAddressCheckSum += (uint16_t ) ( (uint16_t) pAddr[0] | (uint16_t) (pAddr[1] << 8) );
        LDRH     R0,[SP, #+0]
        LDRB     R1,[R6, #+0]
        LDRB     R2,[R6, #+1]
        ORRS     R1,R1,R2, LSL #+8
        ADDS     R0,R1,R0
        STRH     R0,[SP, #+0]
//  393 
//  394       if(AddrMode == gPhyAddrMode64BitAddr_c)
        UXTB     R7,R7            ;; ZeroExt  R7,R7,#+24,#+24
        CMP      R7,#+3
        BNE.N    ??PhyPp_AddToIndirect_0
//  395       {
//  396           srcAddressCheckSum += (uint16_t ) ( (uint16_t) pAddr[2] | (uint16_t) (pAddr[3] << 8) );
        LDRH     R0,[SP, #+0]
        LDRB     R1,[R6, #+2]
        LDRB     R2,[R6, #+3]
        ORRS     R1,R1,R2, LSL #+8
        ADDS     R0,R1,R0
        STRH     R0,[SP, #+0]
//  397           srcAddressCheckSum += (uint16_t ) ( (uint16_t) pAddr[4] | (uint16_t) (pAddr[5] << 8) );
        LDRH     R0,[SP, #+0]
        LDRB     R1,[R6, #+4]
        LDRB     R2,[R6, #+5]
        ORRS     R1,R1,R2, LSL #+8
        ADDS     R0,R1,R0
        STRH     R0,[SP, #+0]
//  398           srcAddressCheckSum += (uint16_t ) ( (uint16_t) pAddr[6] | (uint16_t) (pAddr[7] << 8) );
        LDRH     R0,[SP, #+0]
        LDRB     R1,[R6, #+6]
        LDRB     R2,[R6, #+7]
        ORRS     R1,R1,R2, LSL #+8
        ADDS     R0,R1,R0
        STRH     R0,[SP, #+0]
//  399       }
//  400 
//  401       srcCtrlReg = (uint8_t) ( (index & cSRC_CTRL_INDEX) << cSRC_CTRL_INDEX_Shift_c );
??PhyPp_AddToIndirect_0:
        LSLS     R0,R4,#+4
        MOV      R8,R0
//  402 
//  403       MC1324xDrv_DirectAccessSPIWrite( (uint8_t) SRC_CTRL, srcCtrlReg);
        MOV      R1,R8
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+8
        BL       MC1324xDrv_DirectAccessSPIWrite
//  404 
//  405       MC1324xDrv_DirectAccessSPIMultiByteWrite( (uint8_t) SRC_ADDRS_SUM_LSB, (uint8_t *) &srcAddressCheckSum, 2);
        MOVS     R2,#+2
        ADD      R1,SP,#+0
        MOVS     R0,#+9
        BL       MC1324xDrv_DirectAccessSPIMultiByteWrite
//  406 
//  407       srcCtrlReg |= ( cSRC_CTRL_SRCADDR_EN | cSRC_CTRL_INDEX_EN );
        ORRS     R8,R8,#0x6
//  408 
//  409       MC1324xDrv_DirectAccessSPIWrite( (uint8_t) SRC_CTRL, srcCtrlReg);
        MOV      R1,R8
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+8
        BL       MC1324xDrv_DirectAccessSPIWrite
//  410 }
        POP      {R0,R1,R4-R8,PC}  ;; return
//  411 
//  412 /*---------------------------------------------------------------------------
//  413  * Name: PhyPp_RemoveFromIndirect
//  414  * Description: -
//  415  * Parameters: -
//  416  * Return: -
//  417  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  418 void PhyPp_RemoveFromIndirect
//  419 (
//  420   uint8_t index
//  421 )
//  422 {
PhyPp_RemoveFromIndirect:
        PUSH     {R3-R5,LR}
        MOVS     R4,R0
//  423   uint8_t srcCtrlReg;
//  424   
//  425   //PHY_DEBUG_LOG1(PDBG_PP_REMOVE_INDIRECT, index); TODO
//  426   
//  427   srcCtrlReg = (uint8_t)( ( (index & cSRC_CTRL_INDEX) << cSRC_CTRL_INDEX_Shift_c )
//  428                              |( cSRC_CTRL_SRCADDR_EN )
//  429                                  |( cSRC_CTRL_INDEX_DISABLE) );
        LSLS     R0,R4,#+4
        ORRS     R0,R0,#0x5
        MOVS     R5,R0
//  430   
//  431   MC1324xDrv_DirectAccessSPIWrite( (uint8_t) SRC_CTRL, srcCtrlReg);
        MOVS     R1,R5
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+8
        BL       MC1324xDrv_DirectAccessSPIWrite
//  432 }
        POP      {R0,R4,R5,PC}    ;; return
//  433 
//  434 /*---------------------------------------------------------------------------
//  435  * Name: PhyPpReadLatestIndex
//  436  * Description: -
//  437  * Parameters: -
//  438  * Return: -
//  439  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  440 uint8_t PhyPpReadLatestIndex
//  441 (
//  442   void
//  443 )
//  444 {
PhyPpReadLatestIndex:
        PUSH     {R4,LR}
//  445 	uint8_t srcCtrlReg;
//  446 
//  447 	    srcCtrlReg = MC1324xDrv_DirectAccessSPIRead( (uint8_t) SRC_CTRL);
        MOVS     R0,#+8
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R4,R0
//  448 
//  449 	    srcCtrlReg = (srcCtrlReg >> cSRC_CTRL_INDEX_Shift_c);
        UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
        LSRS     R4,R4,#+4
//  450 
//  451 	    //PHY_DEBUG_LOG1(PDBG_PP_READ_LATEST_INDEX, srcCtrlReg); //TODO
//  452 
//  453 	    return srcCtrlReg;
        MOVS     R0,R4
        UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
        POP      {R4,PC}          ;; return
//  454 }
//  455 
//  456 /*---------------------------------------------------------------------------
//  457  * Name: PhyPpGetState
//  458  * Description: -
//  459  * Parameters: -
//  460  * Return: -
//  461  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  462 uint8_t PhyPpGetState
//  463 (
//  464   void
//  465 )
//  466 {
PhyPpGetState:
        PUSH     {R7,LR}
//  467   return (uint8_t)( MC1324xDrv_DirectAccessSPIRead( (uint8_t) PHY_CTRL1) & cPHY_CTRL1_XCVSEQ );
        MOVS     R0,#+3
        BL       MC1324xDrv_DirectAccessSPIRead
        ANDS     R0,R0,#0x7
        POP      {R1,PC}          ;; return
//  468 }
//  469 
//  470 /*---------------------------------------------------------------------------
//  471  * Name: PhyAbort
//  472  * Description: -
//  473  * Parameters: -
//  474  * Return: -
//  475  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(2)
        THUMB
//  476 void PhyAbort(void)
//  477 {
PhyAbort:
        PUSH     {R3-R11,LR}
//  478 
//  479   uint8_t irqSts1Reg, irqSts2Reg, irqSts3Reg, phyCtrl1Reg, phyCtrl2Reg, phyCtrl3Reg, phyCtrl4Reg;
//  480   volatile uint8_t time = 0;
        MOVS     R0,#+0
        STRB     R0,[SP, #+0]
//  481   uint32_t irqMaskRegister;
//  482 
//  483   asm(" MRS %0,PRIMASK" : "=r" (irqMaskRegister) );
        MRS R0,PRIMASK
        MOV      R9,R0
//  484   asm(" CPSID i");
        CPSID i
//  485   
//  486   //PHY_DEBUG_LOG(PDBG_PHY_ABORT); TODO
//  487 
//  488   
//  489   // disable timer trigger of the already programmed packet processor sequence, if any
//  490   phyCtrl1Reg = MC1324xDrv_DirectAccessSPIRead(PHY_CTRL1);
        MOVS     R0,#+3
        BL       MC1324xDrv_DirectAccessSPIRead
        MOV      R10,R0
//  491   phyCtrl1Reg &= (uint8_t) ~(cPHY_CTRL1_TMRTRIGEN);
        ANDS     R10,R10,#0x7F
//  492   MC1324xDrv_DirectAccessSPIWrite(PHY_CTRL1, phyCtrl1Reg);
        MOV      R1,R10
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+3
        BL       MC1324xDrv_DirectAccessSPIWrite
//  493   
//  494   // give the FSM enough time to start if it was triggered
//  495   time = MC1324xDrv_DirectAccessSPIRead(EVENT_TMR_LSB);
        MOVS     R0,#+12
        BL       MC1324xDrv_DirectAccessSPIRead
        STRB     R0,[SP, #+0]
//  496   while(MC1324xDrv_DirectAccessSPIRead(EVENT_TMR_LSB) < (uint8_t) (time + 6));//TODO
??PhyAbort_0:
        MOVS     R0,#+12
        BL       MC1324xDrv_DirectAccessSPIRead
        LDRB     R1,[SP, #+0]
        ADDS     R1,R1,#+6
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        CMP      R0,R1
        BCC.N    ??PhyAbort_0
//  497   
//  498   // make sure that we abort in HW only if the sequence was actually started (tmr triggered)
//  499   if((gIdle_c != PhyGetSeqState()) && ((MC1324xDrv_DirectAccessSPIRead(SEQ_STATE)&0x1F) != 0))
        BL       PhyPpGetState
        CMP      R0,#+0
        BEQ.N    ??PhyAbort_1
        MOVS     R0,#+36
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R1,#+31
        TST      R0,R1
        BEQ.N    ??PhyAbort_1
//  500   {
//  501     phyCtrl1Reg &= (uint8_t) ~(cPHY_CTRL1_XCVSEQ);
        ANDS     R10,R10,#0xF8
//  502     MC1324xDrv_DirectAccessSPIWrite(PHY_CTRL1, phyCtrl1Reg);
        MOV      R1,R10
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+3
        BL       MC1324xDrv_DirectAccessSPIWrite
//  503     while ((MC1324xDrv_DirectAccessSPIRead(SEQ_STATE) & 0x1F) != 0);
??PhyAbort_2:
        MOVS     R0,#+36
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R1,#+31
        TST      R0,R1
        BNE.N    ??PhyAbort_2
//  504   }
//  505   
//  506  
//  507   phyCtrl2Reg = MC1324xDrv_DirectAccessSPIRead(PHY_CTRL2);
??PhyAbort_1:
        MOVS     R0,#+4
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R6,R0
//  508   phyCtrl3Reg = MC1324xDrv_DirectAccessSPIRead(PHY_CTRL3);
        MOVS     R0,#+5
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R7,R0
//  509   phyCtrl4Reg = MC1324xDrv_DirectAccessSPIRead(PHY_CTRL4);
        MOVS     R0,#+7
        BL       MC1324xDrv_DirectAccessSPIRead
        MOV      R8,R0
//  510 
//  511   // mask SEQ interrupt
//  512   phyCtrl2Reg |= (uint8_t) (cPHY_CTRL2_SEQMSK);
        ORRS     R6,R6,#0x1
//  513   MC1324xDrv_DirectAccessSPIWrite(PHY_CTRL2, phyCtrl2Reg);
        MOVS     R1,R6
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+4
        BL       MC1324xDrv_DirectAccessSPIWrite
//  514  
//  515   // stop timers
//  516   phyCtrl4Reg &= (uint8_t) ~(cPHY_CTRL4_TC3TMOUT);
        ANDS     R8,R8,#0xBF
//  517   phyCtrl3Reg &= (uint8_t) ~(cPHY_CTRL3_TMR2CMP_EN | cPHY_CTRL3_TMR3CMP_EN);
        ANDS     R7,R7,#0x9F
//  518   MC1324xDrv_DirectAccessSPIWrite(PHY_CTRL3, phyCtrl3Reg);
        MOVS     R1,R7
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+5
        BL       MC1324xDrv_DirectAccessSPIWrite
//  519   
//  520   PhyPassRxParams(NULL);
        MOVS     R0,#+0
        BL       PhyPassRxParams
//  521   PhyPassRxDataPtr(NULL);
        MOVS     R0,#+0
        BL       PhyPassRxDataPtr
//  522   
//  523   // clear all PP IRQ bits to avoid unexpected interrupts
//  524   irqSts1Reg = MC1324xDrv_DirectAccessSPIRead(IRQSTS1);
        MOVS     R0,#+0
        BL       MC1324xDrv_DirectAccessSPIRead
        MOV      R11,R0
//  525   irqSts2Reg = MC1324xDrv_DirectAccessSPIRead(IRQSTS2);
        MOVS     R0,#+1
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R4,R0
//  526   irqSts3Reg = MC1324xDrv_DirectAccessSPIRead(IRQSTS3);
        MOVS     R0,#+2
        BL       MC1324xDrv_DirectAccessSPIRead
        MOVS     R5,R0
//  527   
//  528   irqSts3Reg |= (uint8_t) (cIRQSTS3_TMR2MSK | cIRQSTS3_TMR3MSK);
        ORRS     R5,R5,#0x60
//  529   
//  530   MC1324xDrv_DirectAccessSPIWrite(IRQSTS1, irqSts1Reg);
        MOV      R1,R11
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+0
        BL       MC1324xDrv_DirectAccessSPIWrite
//  531   MC1324xDrv_DirectAccessSPIWrite(IRQSTS2, irqSts2Reg);
        MOVS     R1,R4
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+1
        BL       MC1324xDrv_DirectAccessSPIWrite
//  532   MC1324xDrv_DirectAccessSPIWrite(IRQSTS3, irqSts3Reg);
        MOVS     R1,R5
        UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
        MOVS     R0,#+2
        BL       MC1324xDrv_DirectAccessSPIWrite
//  533 
//  534   asm(" MSR PRIMASK, %0" : : "r" (irqMaskRegister) );
        MSR PRIMASK, R9
//  535 }
        POP      {R0,R4-R11,PC}   ;; return
//  536 
//  537 /*---------------------------------------------------------------------------
//  538  * Name: PhyInit
//  539  * Description: -
//  540  * Parameters: -
//  541  * Return: -
//  542  *---------------------------------------------------------------------------*/

        SECTION `.text`:CODE:NOROOT(1)
        THUMB
//  543 void PhyInit(void)
//  544 {
PhyInit:
        PUSH     {R4,LR}
//  545   uint8_t u8PartId = 0;
        MOVS     R4,#+0
//  546   PhyPassRxParams(NULL);
        MOVS     R0,#+0
        BL       PhyPassRxParams
//  547   PhyPassRxDataPtr(NULL);
        MOVS     R0,#+0
        BL       PhyPassRxDataPtr
//  548   
//  549   //@AC added: Verify the Radio IC version Indirect register 0x00
//  550   
//  551   u8PartId = MC1324xDrv_IndirectAccessSPIRead(PART_ID);
        MOVS     R0,#+0
        BL       MC1324xDrv_IndirectAccessSPIRead
        MOVS     R4,R0
//  552   
//  553   if((gRadioPartId_2p0 == u8PartId)|| (gRadioPartId_2p1 == u8PartId))
        UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
        CMP      R4,#+24
        BEQ.N    ??PhyInit_0
        UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
        CMP      R4,#+25
        BNE.N    ??PhyInit_1
//  554   {
//  555       // Direct Registers
//  556       MC1324xDrv_DirectAccessSPIWrite(OVERWRITE_VER, 0x0C);  //version 0C: new value for ACKDELAY targeting 198us (23 May, 2013, Larry Roshak)
??PhyInit_0:
        MOVS     R1,#+12
        MOVS     R0,#+59
        BL       MC1324xDrv_DirectAccessSPIWrite
//  557       MC1324xDrv_DirectAccessSPIWrite(PA_PWR,0x17);          // 9:PA_PWR new default Power Step is "23"  (24 Jan, 2013, Doug Shade)   
        MOVS     R1,#+23
        MOVS     R0,#+35
        BL       MC1324xDrv_DirectAccessSPIWrite
//  558       
//  559       MC1324xDrv_DirectAccessSPIWrite(PHY_CTRL4,0x4B);       // TC3TMOUT, CCATYPE, PROMISCUOUS, TC2PRIME_EN bits set on PHYCTRL4 reg (@SMAC)
        MOVS     R1,#+75
        MOVS     R0,#+7
        BL       MC1324xDrv_DirectAccessSPIWrite
//  560       MC1324xDrv_DirectAccessSPIWrite(SRC_CTRL,0x01);        // disable Index for source address table feature (@SMAC)
        MOVS     R1,#+1
        MOVS     R0,#+8
        BL       MC1324xDrv_DirectAccessSPIWrite
//  561       
//  562       // Indirect Registers  
//  563       MC1324xDrv_IndirectAccessSPIWrite(RX_FRAME_FILTER, 0x1F); 
        MOVS     R1,#+31
        MOVS     R0,#+15
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  564       
//  565       /* Overwrites section start */
//  566       MC1324xDrv_IndirectAccessSPIWrite(0x31, 0x02);        //clear MISO_HIZ_EN (for single SPI master/slave pair) and SPI_PUL_EN (minimize HIB currents) (17 Apr 2012, D. Brown)
        MOVS     R1,#+2
        MOVS     R0,#+49
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  567       MC1324xDrv_IndirectAccessSPIWrite(0x91, 0xB3);        //VCO_CTRL1: override VCOALC_REF_TX to 3 (13 Sep 2012, D. Brown)
        MOVS     R1,#+179
        MOVS     R0,#+145
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  568       MC1324xDrv_IndirectAccessSPIWrite(0x92, 0x07);        //VCO_CTRL2: override VCOALC_REF_RX to 3, keep VCO_BUF_BOOST = 1 (13 Sep 2012, D. Brown)
        MOVS     R1,#+7
        MOVS     R0,#+146
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  569       MC1324xDrv_IndirectAccessSPIWrite(0x8A, 0x71);        //PA_TUNING: override PA_COILTUNING to 001 (27 Nov 2012, D. Brown, on behalf of S. Eid)
        MOVS     R1,#+113
        MOVS     R0,#+138
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  570       MC1324xDrv_IndirectAccessSPIWrite(0x79, 0x2F);        //CHF_IBUF  Adjust the gm-C filter gain (+/- 6dB)         (21 Dec, 2012, on behalf of S. Soca) 
        MOVS     R1,#+47
        MOVS     R0,#+121
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  571       MC1324xDrv_IndirectAccessSPIWrite(0x7A, 0x2F);        //CHF_QBUF  Adjust the gm-C filter gain (+/- 6dB)         (21 Dec, 2012, on behalf of S. Soca) 
        MOVS     R1,#+47
        MOVS     R0,#+122
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  572       MC1324xDrv_IndirectAccessSPIWrite(0x7B, 0x24);        //CHF_IRIN  Adjust the filter bandwidth (+/- 0.5MHz)      (21 Dec, 2012, on behalf of S. Soca) 
        MOVS     R1,#+36
        MOVS     R0,#+123
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  573       MC1324xDrv_IndirectAccessSPIWrite(0x7C, 0x24);        //CHF_QRIN  Adjust the filter bandwidth (+/- 0.5MHz)      (21 Dec, 2012, on behalf of S. Soca) 
        MOVS     R1,#+36
        MOVS     R0,#+124
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  574       MC1324xDrv_IndirectAccessSPIWrite(0x7D, 0x24);        //CHF_IL    Adjust the filter bandwidth (+/- 0.5MHz)      (21 Dec, 2012, on behalf of S. Soca) 
        MOVS     R1,#+36
        MOVS     R0,#+125
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  575       MC1324xDrv_IndirectAccessSPIWrite(0x7E, 0x24);        //CHF_QL    Adjust the filter bandwidth (+/- 0.5MHz)      (21 Dec, 2012, on behalf of S. Soca)
        MOVS     R1,#+36
        MOVS     R0,#+126
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  576       MC1324xDrv_IndirectAccessSPIWrite(0x7F, 0x32);        //CHF_CC1   Adjust the filter center frequency (+/- 1MHz) (21 Dec, 2012, on behalf of S. Soca) 
        MOVS     R1,#+50
        MOVS     R0,#+127
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  577       MC1324xDrv_IndirectAccessSPIWrite(0x80, 0x1D);        //CHF_CCL   Adjust the filter center frequency (+/- 1MHz) (21 Dec, 2012, on behalf of S. Soca) 
        MOVS     R1,#+29
        MOVS     R0,#+128
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  578       MC1324xDrv_IndirectAccessSPIWrite(0x81, 0x2D);        //CHF_CC2   Adjust the filter center frequency (+/- 1MHz) (21 Dec, 2012, on behalf of S. Soca)  
        MOVS     R1,#+45
        MOVS     R0,#+129
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  579       MC1324xDrv_IndirectAccessSPIWrite(0x82, 0x24);        //CHF_IROUT Adjust the filter bandwidth (+/- 0.5MHz)      (21 Dec, 2012, on behalf of S. Soca) 
        MOVS     R1,#+36
        MOVS     R0,#+130
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  580       MC1324xDrv_IndirectAccessSPIWrite(0x83, 0x24);        //CHF_QROUT Adjust the filter bandwidth (+/- 0.5MHz)      (21 Dec, 2012, on behalf of S. Soca) 
        MOVS     R1,#+36
        MOVS     R0,#+131
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  581       MC1324xDrv_IndirectAccessSPIWrite(0x64, 0x28);        //PA_CAL_DIS=1  Disabled PA calibration (3 Jan 2013, Andy Chiang)
        MOVS     R1,#+40
        MOVS     R0,#+100
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  582       MC1324xDrv_IndirectAccessSPIWrite(0x52, 0x55);        //AGC_THR1 RSSI tune up (24 Jan 2013, Andy Chiang)
        MOVS     R1,#+85
        MOVS     R0,#+82
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  583       MC1324xDrv_IndirectAccessSPIWrite(0x53, 0x2D);        //AGC_THR2 RSSI tune up (7 Jan 2013, Andy Chiang)
        MOVS     R1,#+45
        MOVS     R0,#+83
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  584       MC1324xDrv_IndirectAccessSPIWrite(0x66, 0x5F);        //ATT_RSSI1 tune up     (7 Jan 2013, Andy Chiang)
        MOVS     R1,#+95
        MOVS     R0,#+102
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  585       MC1324xDrv_IndirectAccessSPIWrite(0x67, 0x8F);        //ATT_RSSI2 tune up     (7 Jan 2013, Andy Chiang)
        MOVS     R1,#+143
        MOVS     R0,#+103
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  586       MC1324xDrv_IndirectAccessSPIWrite(0x68, 0x61);        //RSSI_OFFSET (9 Jan 2013, Andy Chiang)
        MOVS     R1,#+97
        MOVS     R0,#+104
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  587       MC1324xDrv_IndirectAccessSPIWrite(0x78, 0x03);        //CHF_PMAGAIN (9 Jan 2013, Andy Chiang)
        MOVS     R1,#+3
        MOVS     R0,#+120
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  588       MC1324xDrv_IndirectAccessSPIWrite(0x22, 0x50);        //CCA1_THRESH (11 Feb 2013, Andy Chiang)
        MOVS     R1,#+80
        MOVS     R0,#+34
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  589       MC1324xDrv_IndirectAccessSPIWrite(0x4D, 0x13);        //Moved from 0x14 to 0x13 for 0.5 dB improved Rx Sensitivity (01 Apr 2013, D. Shade)
        MOVS     R1,#+19
        MOVS     R0,#+77
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  590       MC1324xDrv_IndirectAccessSPIWrite(0x39, 0x3D);        //ACKDELAY new value targeting a delay of 198us (23 May, 2013, Larry Roshak)
        MOVS     R1,#+61
        MOVS     R0,#+57
        BL       MC1324xDrv_IndirectAccessSPIWrite
        B.N      ??PhyInit_2
//  591      /* Overwrites section ends */
//  592   }
//  593   else
//  594   {
//  595       if((gRadioPartId_TV1 == u8PartId) || (gRadioPartId_TV2 == u8PartId) || (gRadioPartId_TV3 == u8PartId))
??PhyInit_1:
        UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
        CMP      R4,#+72
        BEQ.N    ??PhyInit_3
        UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
        CMP      R4,#+136
        BEQ.N    ??PhyInit_3
        UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
        CMP      R4,#+200
        BNE.N    ??PhyInit_2
//  596       {
//  597           // Direct Registers
//  598           MC1324xDrv_DirectAccessSPIWrite(OVERWRITE_VER, 0x05);   
??PhyInit_3:
        MOVS     R1,#+5
        MOVS     R0,#+59
        BL       MC1324xDrv_DirectAccessSPIWrite
//  599           MC1324xDrv_DirectAccessSPIWrite(PHY_CTRL4,0x4B);
        MOVS     R1,#+75
        MOVS     R0,#+7
        BL       MC1324xDrv_DirectAccessSPIWrite
//  600           MC1324xDrv_DirectAccessSPIWrite(SRC_CTRL,0x01); // disable Index for source address table feature
        MOVS     R1,#+1
        MOVS     R0,#+8
        BL       MC1324xDrv_DirectAccessSPIWrite
//  601          
//  602           // Indirect Registers  
//  603           MC1324xDrv_IndirectAccessSPIWrite(RX_FRAME_FILTER, 0x1F); 
        MOVS     R1,#+31
        MOVS     R0,#+15
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  604           
//  605           /* Overwrites section start */
//  606           MC1324xDrv_IndirectAccessSPIWrite(0x31, 0x02); //clear MISO_HIZ_EN (for single SPI master/slave pair) and SPI_PUL_EN (minimize HIB currents) (17 Apr 2012, D. Brown)
        MOVS     R1,#+2
        MOVS     R0,#+49
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  607           MC1324xDrv_IndirectAccessSPIWrite(0x79, 0x1B); //fine tune I-Channel gm-C filter gain (+/- 6dB) CHF_IBUF[5:0]=0x1B(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+27
        MOVS     R0,#+121
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  608           MC1324xDrv_IndirectAccessSPIWrite(0x7A, 0x1B); //fine tune Q-Channel gm-C filter gain (+/- 6dB) CHF_QBUF[5:0]=0x1B(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+27
        MOVS     R0,#+122
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  609           MC1324xDrv_IndirectAccessSPIWrite(0x7B, 0x20); //fine tune I-Channel CHF_IRIN filter bandwidth (+/- 0.5MHz)  CHF_IRIN[5:0]=0x20(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+32
        MOVS     R0,#+123
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  610           MC1324xDrv_IndirectAccessSPIWrite(0x7C, 0x20); //fine tune Q-Channel CHF_QRIN filter bandwidth (+/- 0.5MHz)  CHF_QRIN[5:0]=0x20(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+32
        MOVS     R0,#+124
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  611           MC1324xDrv_IndirectAccessSPIWrite(0x7D, 0x20); //fine tune I-Channel CHF_IL filter bandwidth (+/- 0.5MHz)  CHF_IL[5:0]=0x20(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+32
        MOVS     R0,#+125
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  612           MC1324xDrv_IndirectAccessSPIWrite(0x7E, 0x20); //fine tune Q-Channel CHF_QL filter bandwidth (+/- 0.5MHz)  CHF_QL[5:0]=0x20(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+32
        MOVS     R0,#+126
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  613           MC1324xDrv_IndirectAccessSPIWrite(0x82, 0x20); //fine tune I-Channel CHF_IROUT filter bandwidth (+/- 0.5MHz)  CHF_IROUT[5:0]=0x20(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+32
        MOVS     R0,#+130
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  614           MC1324xDrv_IndirectAccessSPIWrite(0x83, 0x20); //fine tune Q-Channel CHF_QROUT filter bandwidth (+/- 0.5MHz)  CHF_QROUT[5:0]=0x20(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+32
        MOVS     R0,#+131
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  615           MC1324xDrv_IndirectAccessSPIWrite(0x7F, 0x30); //fine tune I-Channel CHF_CC1 center frequency (+/- 1MHz)  CHF_CC1[5:0]=0x30(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+48
        MOVS     R0,#+127
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  616           MC1324xDrv_IndirectAccessSPIWrite(0x80, 0x1B); //fine tune Q-Channel CHF_CCL center frequency (+/- 1MHz)  CHF_CCL[5:0]=0x1B(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+27
        MOVS     R0,#+128
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  617           MC1324xDrv_IndirectAccessSPIWrite(0x81, 0x2B); //fine tune I-Channel CHF_CC2 center frequency (+/- 1MHz)  CHF_CC2[5:0]=0x2B(23 Apr, 2012, Jalaleddine)
        MOVS     R1,#+43
        MOVS     R0,#+129
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  618           MC1324xDrv_IndirectAccessSPIWrite(0x67, 0x11); //ATT_RSSI2 register: Disable RSSI Auto Calibration (see TKT116800)
        MOVS     R1,#+17
        MOVS     R0,#+103
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  619           MC1324xDrv_IndirectAccessSPIWrite(0x64, 0x28); //set PA_CAL_DIS=1 to reduce current consumption of the PA output stage (25 Apr, 2012, A.Chiang)
        MOVS     R1,#+40
        MOVS     R0,#+100
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  620           MC1324xDrv_IndirectAccessSPIWrite(0x92, 0x01); //VCO_BUF_BOOST = 1
        MOVS     R1,#+1
        MOVS     R0,#+146
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  621           MC1324xDrv_IndirectAccessSPIWrite(0x75, 0x00); //LNA_BIAS_BOOST[1:0] = 00
        MOVS     R1,#+0
        MOVS     R0,#+117
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  622           MC1324xDrv_IndirectAccessSPIWrite(0x52, 0x3C); //AGC_THR1 RSSI response tune up (06 Aug, 2012, Murthy/Delbecq)
        MOVS     R1,#+60
        MOVS     R0,#+82
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  623           MC1324xDrv_IndirectAccessSPIWrite(0x53, 0xFF); //AGC_THR2 RSSI response tune up, basically disables LNA high attenuation mode (06 Aug, 2012, Murthy/Delbecq)
        MOVS     R1,#+255
        MOVS     R0,#+83
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  624           MC1324xDrv_IndirectAccessSPIWrite(0x66, 0x5F); //ATT_RSS1 RSSI response tune up (06 Aug, 2012, Murthy/Delbecq)
        MOVS     R1,#+95
        MOVS     R0,#+102
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  625           MC1324xDrv_IndirectAccessSPIWrite(0x23, 0x6D); //CCA1_ED_OFFSET_COM RSSI response tune up (06 Aug, 2012, Murthy/Delbecq)
        MOVS     R1,#+109
        MOVS     R0,#+35
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  626           MC1324xDrv_IndirectAccessSPIWrite(0x24, 0x24); //LQI_OFFSET_COMP    RSSI response tune up (06 Aug, 2012, Murthy/Delbecq)
        MOVS     R1,#+36
        MOVS     R0,#+36
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  627           MC1324xDrv_IndirectAccessSPIWrite(0x61, 0x36); //VCO_BIAS Disables ALC, sets VCO_CAL to 0x16 (06 Aug, 2012, Jalaleddine)
        MOVS     R1,#+54
        MOVS     R0,#+97
        BL       MC1324xDrv_IndirectAccessSPIWrite
//  628          /* Overwrites section ends */
//  629       }
//  630   }
//  631            
//  632       PhyPlmeSetCurrentChannelRequest(0x0B);        // Set Initial freq. at 2405 MHz
??PhyInit_2:
        MOVS     R0,#+11
        BL       PhyPlmeSetCurrentChannelRequestPAN0
//  633       PhyPlmeSetPwrLevelRequest(0x17);              // Set Initial power level to 0dBm
        MOVS     R0,#+23
        BL       PhyPlmeSetPwrLevelRequest
//  634       PhyPpSetCcaThreshold(0x4B);                   // set CCA1 threshold to -75 dBm
        MOVS     R0,#+75
        BL       PhyPpSetCcaThreshold
//  635       
//  636       MC1324xDrv_IRQ_Clear();
        BL       MC1324xDrv_IRQ_Clear
//  637       NVIC_ClearPendingIRQ(MC1324x_Irq_Number);
        MOVS     R0,#+60
        BL       NVIC_ClearPendingIRQ
//  638   
//  639 }
        POP      {R4,PC}          ;; return

        SECTION `.iar_vfe_header`:DATA:NOALLOC:NOROOT(2)
        SECTION_TYPE SHT_PROGBITS, 0
        DATA
        DC32 0

        END
// 
// 1 284 bytes in section .text
// 
// 1 284 bytes of CODE memory
//
//Errors: none
//Warnings: none
